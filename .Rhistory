#dataTable
dataPost<-data.frame(c(dimnames(dataEA$post.mode[[1]])[[1]],
dimnames(dataEA$post.mode[[2]])[[1]],
dimnames(dataEA$post.mode[[3]])[[1]]),
unlist(dataEA[["post.mode"]]),unlist(dataEA[["post.mean"]]),
unlist(dataEA[["post.hdpinf"]]),unlist(dataEA[["post.hdpsup"]]),
unlist(dataUS[["post.mode"]]),unlist(dataUS[["post.mean"]]),
unlist(dataUS[["post.hdpinf"]]),unlist(dataUS[["post.hdpsup"]]))
names(dataPost)<-c("names","Post. mode EA","Post. mean EA","Prob. Interval 10% EA","Prob. Interval 90% EA","Post. mode US","Post. mean US","Prob. Interval 10% US","Prob. Interval 90% US")
dataPost$names<-gsub(".","_",dataPost$names,fixed=TRUE)
dataPrior<-data.frame(names=unlist(dataEA[["params.names"]]),
prior_mean=unlist(dataEA[["prior.mean"]]),
prior_var=diag(unlist(dataEA[["prior.var"]])))
#,prior_stdv=sqrt(unlist(dataEA[["prior.var"]]))
names(dataPrior)<-c('names','Prior mean','Prior var.')
dataTable<-merge(dataPrior,dataPost,by="names",sort=F)
save(obsnames,dataRaw,dataDecompo,dataSum,dataTable,file="C:/Users/brand/Dropbox/github/riskshocks/data.RData")
# library(ggplot2)
#
# data<-rbind(ea,us)
# data<-melt(data,id.vars=c("year","co"))
# ggplot(data=data,aes(x=year,y=value,color=co,group=co)) +
#   geom_line(size=.5) + xlab(NULL) + ylab(NULL)+
#   facet_wrap(~variable,scales="free_y")+
#   theme(legend.position="bottom",
#         legend.title=element_blank())
# ggsave(file="comparison_EAUS.pdf")
#
# data<-rbind(cmr,us)
# data<-melt(data,id.vars=c("year","co"))
# ggplot(data=data,aes(x=year,y=value,color=co,group=co)) +
#   geom_line(size=.5) + xlab(NULL) + ylab(NULL)+
#   facet_wrap(~variable,scales="free_y")+
#   theme(legend.position="bottom",
#         legend.title=element_blank())
# ggsave(file="comparison_CMRUS.pdf")
setwd("C:/Users/brand/Dropbox/github/riskshocks")
runApp()
library(R.matlab)
library(reshape2)
library(plyr)
library(lubridate)
setwd("C:/Users/Brand/Dropbox/cepii_dsge/output")
#dataCMR (annualized data_BAAoverTB.mat)
data<-readMat("rawdataCMR.mat")
year1<-seq(as.Date("1981/12/1"), as.Date("2010/6/1"), by = "3 months")
data<-data.frame(data,time=year1,country="US_CMR",shock="rawdataCMR")
rawdataCMR<-melt(data,id.vars=c("time","country","shock")) #12*118
rawdataCMR$variable<-gsub(".obs","",rawdataCMR$variable,fixed=TRUE)
rawdataCMR<-subset(rawdataCMR,year(time)>1987)
year<-as.character(seq(as.Date("1988/3/1"), as.Date("2013/6/1"), by = "3 months"))
#rawdata annualized, with or without mean (13x2x2x102=5304 obs.)
data<-read.csv("./rawdata4.csv",header=T,dec=',',sep=';')
data["time"]<-year
rawdata4<-melt(data,id.vars=c("time","country","shock"))
rawdata4$time<-as.Date(as.character(rawdata4$time))
rawdata4$variable<-gsub("_obs","",rawdata4$variable,fixed=TRUE)
dataRaw<-rbind(rawdata4,rawdataCMR) #(5304+1416)
dataEA<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_ea/table4/baseline/cmr_output.mat")
#obsnames contains 13 items (13observed variables)
obsnames<-gsub("_obs","",dataEA[["sim.endonames"]],fixed=TRUE)
obsnames<-gsub(" ","",obsnames,fixed=TRUE)
#exonames contains 21 items (13shocks+8news)
exonames<-gsub( " ", "",dataEA[["sim.exonames"]],fixed=TRUE)
datEA<-data.frame()
for (i in 1:length(obsnames)){
datEA<-rbind(datEA,data.frame(variable=obsnames[i],
name=c(exonames,"initial","sumshocks"),
dataEA[["sim"]][i,,]
)
)
}
datEA["country"]<-"EA"
dataUS<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline/cmr_output.mat")
datUS<-data.frame()
for (i in 1:length(obsnames)){
datUS<-rbind(datUS,data.frame(variable=obsnames[i],
name=c(exonames,"initial","sumshocks"),
dataUS[["sim"]][i,,]
)
)
}
datUS["country"]<-"US"
data<-rbind(datEA,datUS)
names(data)<-c("variable","shock",year,"country")
meltdata<-melt(data,measure.var=year) #(13*2*102*23=60996)
names(meltdata)[4]<-"time"
shocknewsnames<-exonames[9:17]
subdata<-subset(meltdata,shock %in% shocknewsnames)
risk_df<-data.frame(ddply(subdata,.(country,variable,time),summarize,value = sum(value)),shock="risk")
data<-subset(meltdata,!(shock %in% cbind(shocknewsnames,"initial")))
data<-rbind(data,risk_df)
levels(data$shock)<-list("sum_of_shocks"="sumshocks","technology"="e_epsil","govexp"="e_g","equity"="e_gamma",
"goodsmarkup"="e_lambdaf","investmentprod"="e_muup",
"tfp"="e_muzstar","inflationtarget"="e_pitarget",
"consopreferences"="e_zetac","investmentefficiency"="e_zetai",
"risk"="risk","term"="e_term","monetary"="e_xp","transfer"="e_tauf")
data$time<-as.Date(data$time)
dataDecompo<-subset(data,!(shock == "sum_of_shocks")) #(13*2*102*13=34476)
dataSum<-subset(data,shock == "sum_of_shocks") #(13*2*102)
#dataTable
dataPost<-data.frame(c(dimnames(dataEA$post.mode[[1]])[[1]],
dimnames(dataEA$post.mode[[2]])[[1]],
dimnames(dataEA$post.mode[[3]])[[1]]),
unlist(dataEA[["post.mode"]]),unlist(dataEA[["post.mean"]]),
unlist(dataEA[["post.hdpinf"]]),unlist(dataEA[["post.hdpsup"]]),
unlist(dataUS[["post.mode"]]),unlist(dataUS[["post.mean"]]),
unlist(dataUS[["post.hdpinf"]]),unlist(dataUS[["post.hdpsup"]]))
names(dataPost)<-c("names","Post. mode EA","Post. mean EA","Prob. Interval 10% EA","Prob. Interval 90% EA","Post. mode US","Post. mean US","Prob. Interval 10% US","Prob. Interval 90% US")
dataPost$names<-gsub(".","_",dataPost$names,fixed=TRUE)
dataPrior<-data.frame(names=unlist(dataEA[["params.names"]]),
prior_mean=unlist(dataEA[["prior.mean"]]),
prior_stdv=sqrt(diag(unlist(dataEA[["prior.var"]]))))
#,prior_stdv=sqrt(unlist(dataEA[["prior.var"]]))
names(dataPrior)<-c('names','Prior mean','Prior stdv')
dataTable<-merge(dataPrior,dataPost,by="names",sort=F)
save(obsnames,dataRaw,dataDecompo,dataSum,dataTable,file="C:/Users/brand/Dropbox/github/riskshocks/data.RData")
# library(ggplot2)
#
# data<-rbind(ea,us)
# data<-melt(data,id.vars=c("year","co"))
# ggplot(data=data,aes(x=year,y=value,color=co,group=co)) +
#   geom_line(size=.5) + xlab(NULL) + ylab(NULL)+
#   facet_wrap(~variable,scales="free_y")+
#   theme(legend.position="bottom",
#         legend.title=element_blank())
# ggsave(file="comparison_EAUS.pdf")
#
# data<-rbind(cmr,us)
# data<-melt(data,id.vars=c("year","co"))
# ggplot(data=data,aes(x=year,y=value,color=co,group=co)) +
#   geom_line(size=.5) + xlab(NULL) + ylab(NULL)+
#   facet_wrap(~variable,scales="free_y")+
#   theme(legend.position="bottom",
#         legend.title=element_blank())
# ggsave(file="comparison_CMRUS.pdf")
setwd("C:/Users/brand/Dropbox/github/riskshocks")
runApp()
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
def<-unlist(defsim)
)
length(year)
def<-as.data.frame(defsim)
View(def)
def<-as.data.frame(defsim)[22]
def<-as.data.frame(defsim)[22,]
View(def)
defsim<-as.data.frame(defsim)[22,]
defsim<-t(as.data.frame(defsim)[22,])
View(defsim)
defsim<-as.data.frame(defsim)[22,]
defsim<-as.data.frame(defsim)
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-as.data.frame(defsim)
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-as.data.frame(defsim)[22,]
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-t(as.data.frame(defsim)[22,])
View(defsim)
defsim["time"]<-year
year
length(defsim)
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-t(as.data.frame(defsim)[22,])
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-as.data.frame(t(as.data.frame(defsim)[22,]))
View(defsim)
defsim["time"]<-year
View(defsim)
names(defsim)
View(dataRaw)
truc<-subset(dataRaw,country=="US" & shock == "rawdata4withoutmean" & variable == "def")
View(truc)
truc<-subset(dataRaw,country=="US" & shock == "rawdata4withoutmean" & variable == "def")$value
defsim["rawdata"]<-truc
names(defsim)
names(defsim)[1]<-"deficit"
dataDefSim<-melt(defsim,id.vars=year)
dataDefSim<-melt(defsim,measure.vars=c("rawdata","deficit"))
View(dataDefSim)
library(R.matlab)
library(reshape2)
library(plyr)
library(lubridate)
setwd("C:/Users/Brand/Dropbox/cepii_dsge/output")
#dataCMR (annualized data_BAAoverTB.mat)
data<-readMat("rawdataCMR.mat")
year1<-seq(as.Date("1981/12/1"), as.Date("2010/6/1"), by = "3 months")
data<-data.frame(data,time=year1,country="US_CMR",shock="rawdataCMR")
rawdataCMR<-melt(data,id.vars=c("time","country","shock")) #12*118
rawdataCMR$variable<-gsub(".obs","",rawdataCMR$variable,fixed=TRUE)
rawdataCMR<-subset(rawdataCMR,year(time)>1987)
year<-as.character(seq(as.Date("1988/3/1"), as.Date("2013/6/1"), by = "3 months"))
#rawdata annualized, with or without mean (13x2x2x102=5304 obs.)
data<-read.csv("./rawdata4.csv",header=T,dec=',',sep=';')
data["time"]<-year
rawdata4<-melt(data,id.vars=c("time","country","shock"))
rawdata4$time<-as.Date(as.character(rawdata4$time))
rawdata4$variable<-gsub("_obs","",rawdata4$variable,fixed=TRUE)
dataRaw<-rbind(rawdata4,rawdataCMR) #(5304+1416)
dataEA<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_ea/table4/baseline/cmr_output.mat")
#obsnames contains 13 items (13observed variables)
obsnames<-gsub("_obs","",dataEA[["sim.endonames"]],fixed=TRUE)
obsnames<-gsub(" ","",obsnames,fixed=TRUE)
#exonames contains 21 items (13shocks+8news)
exonames<-gsub( " ", "",dataEA[["sim.exonames"]],fixed=TRUE)
datEA<-data.frame()
for (i in 1:length(obsnames)){
datEA<-rbind(datEA,data.frame(variable=obsnames[i],
name=c(exonames,"initial","sumshocks"),
dataEA[["sim"]][i,,]
)
)
}
datEA["country"]<-"EA"
dataUS<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline/cmr_output.mat")
datUS<-data.frame()
for (i in 1:length(obsnames)){
datUS<-rbind(datUS,data.frame(variable=obsnames[i],
name=c(exonames,"initial","sumshocks"),
dataUS[["sim"]][i,,]
)
)
}
datUS["country"]<-"US"
data<-rbind(datEA,datUS)
names(data)<-c("variable","shock",year,"country")
meltdata<-melt(data,measure.var=year) #(13*2*102*23=60996)
names(meltdata)[4]<-"time"
shocknewsnames<-exonames[9:17]
subdata<-subset(meltdata,shock %in% shocknewsnames)
risk_df<-data.frame(ddply(subdata,.(country,variable,time),summarize,value = sum(value)),shock="risk")
data<-subset(meltdata,!(shock %in% cbind(shocknewsnames,"initial")))
data<-rbind(data,risk_df)
levels(data$shock)<-list("sum_of_shocks"="sumshocks","technology"="e_epsil","govexp"="e_g","equity"="e_gamma",
"goodsmarkup"="e_lambdaf","investmentprod"="e_muup",
"tfp"="e_muzstar","inflationtarget"="e_pitarget",
"consopreferences"="e_zetac","investmentefficiency"="e_zetai",
"risk"="risk","term"="e_term","monetary"="e_xp","transfer"="e_tauf")
data$time<-as.Date(data$time)
dataDecompo<-subset(data,!(shock == "sum_of_shocks")) #(13*2*102*13=34476)
dataSum<-subset(data,shock == "sum_of_shocks") #(13*2*102)
#dataTable
dataPost<-data.frame(c(dimnames(dataEA$post.mode[[1]])[[1]],
dimnames(dataEA$post.mode[[2]])[[1]],
dimnames(dataEA$post.mode[[3]])[[1]]),
unlist(dataEA[["post.mode"]]),unlist(dataEA[["post.mean"]]),
unlist(dataEA[["post.hdpinf"]]),unlist(dataEA[["post.hdpsup"]]),
unlist(dataUS[["post.mode"]]),unlist(dataUS[["post.mean"]]),
unlist(dataUS[["post.hdpinf"]]),unlist(dataUS[["post.hdpsup"]]))
names(dataPost)<-c("names","Post. mode EA","Post. mean EA","Prob. Interval 10% EA","Prob. Interval 90% EA","Post. mode US","Post. mean US","Prob. Interval 10% US","Prob. Interval 90% US")
dataPost$names<-gsub(".","_",dataPost$names,fixed=TRUE)
dataPrior<-data.frame(names=unlist(dataEA[["params.names"]]),
prior_mean=unlist(dataEA[["prior.mean"]]),
prior_stdv=sqrt(diag(unlist(dataEA[["prior.var"]]))))
#,prior_stdv=sqrt(unlist(dataEA[["prior.var"]]))
names(dataPrior)<-c('names','Prior mean','Prior stdv')
dataTable<-merge(dataPrior,dataPost,by="names",sort=F)
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-as.data.frame(t(as.data.frame(defsim)[22,]))
defsim["time"]<-year
truc<-subset(dataRaw,country=="US" & shock == "rawdata4withoutmean" & variable == "def")$value
defsim["rawdata"]<-truc
names(defsim)[1]<-"deficit"
dataDefSim<-melt(defsim,measure.vars=c("rawdata","deficit"))
save(obsnames,dataRaw,dataDecompo,dataSum,dataTable,dataDefSim,file="C:/Users/brand/Dropbox/github/riskshocks/data.RData")
setwd("C:/Users/brand/Dropbox/github/riskshocks")
runApp()
runApp()
View(defsim)
View(dataDefSim)
runApp()
dataDefSim["time"]
str(dataDefSim["time"])
dataDefSim["time"]<-as.Date(dataDefSim["time"])
dataDefSim["time"]
dataDefSim["time"]<-as.Date(as.character(dataDefSim["time"]))
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim["time"]<-year
defsim<-as.data.frame(t(as.data.frame(defsim)[22,]))
truc<-subset(dataRaw,country=="US" & shock == "rawdata4withoutmean" & variable == "def")$value
defsim["rawdata"]<-truc
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-as.data.frame(t(as.data.frame(defsim)[22,]))
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-as.data.frame(t(as.data.frame(defsim)[22,]))
defsim["time"]<-year
truc<-subset(dataRaw,country=="US" & shock == "rawdata4withoutmean" & variable == "def")$value
library(R.matlab)
library(reshape2)
library(plyr)
library(lubridate)
setwd("C:/Users/Brand/Dropbox/cepii_dsge/output")
#dataCMR (annualized data_BAAoverTB.mat)
data<-readMat("rawdataCMR.mat")
year1<-seq(as.Date("1981/12/1"), as.Date("2010/6/1"), by = "3 months")
data<-data.frame(data,time=year1,country="US_CMR",shock="rawdataCMR")
rawdataCMR<-melt(data,id.vars=c("time","country","shock")) #12*118
rawdataCMR$variable<-gsub(".obs","",rawdataCMR$variable,fixed=TRUE)
rawdataCMR<-subset(rawdataCMR,year(time)>1987)
year<-as.character(seq(as.Date("1988/3/1"), as.Date("2013/6/1"), by = "3 months"))
#rawdata annualized, with or without mean (13x2x2x102=5304 obs.)
data<-read.csv("./rawdata4.csv",header=T,dec=',',sep=';')
data["time"]<-year
rawdata4<-melt(data,id.vars=c("time","country","shock"))
rawdata4$time<-as.Date(as.character(rawdata4$time))
rawdata4$variable<-gsub("_obs","",rawdata4$variable,fixed=TRUE)
dataRaw<-rbind(rawdata4,rawdataCMR) #(5304+1416)
dataEA<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_ea/table4/baseline/cmr_output.mat")
#obsnames contains 13 items (13observed variables)
obsnames<-gsub("_obs","",dataEA[["sim.endonames"]],fixed=TRUE)
obsnames<-gsub(" ","",obsnames,fixed=TRUE)
#exonames contains 21 items (13shocks+8news)
exonames<-gsub( " ", "",dataEA[["sim.exonames"]],fixed=TRUE)
datEA<-data.frame()
for (i in 1:length(obsnames)){
datEA<-rbind(datEA,data.frame(variable=obsnames[i],
name=c(exonames,"initial","sumshocks"),
dataEA[["sim"]][i,,]
)
)
}
datEA["country"]<-"EA"
dataUS<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline/cmr_output.mat")
datUS<-data.frame()
for (i in 1:length(obsnames)){
datUS<-rbind(datUS,data.frame(variable=obsnames[i],
name=c(exonames,"initial","sumshocks"),
dataUS[["sim"]][i,,]
)
)
}
datUS["country"]<-"US"
data<-rbind(datEA,datUS)
names(data)<-c("variable","shock",year,"country")
meltdata<-melt(data,measure.var=year) #(13*2*102*23=60996)
names(meltdata)[4]<-"time"
shocknewsnames<-exonames[9:17]
subdata<-subset(meltdata,shock %in% shocknewsnames)
risk_df<-data.frame(ddply(subdata,.(country,variable,time),summarize,value = sum(value)),shock="risk")
data<-subset(meltdata,!(shock %in% cbind(shocknewsnames,"initial")))
data<-rbind(data,risk_df)
levels(data$shock)<-list("sum_of_shocks"="sumshocks","technology"="e_epsil","govexp"="e_g","equity"="e_gamma",
"goodsmarkup"="e_lambdaf","investmentprod"="e_muup",
"tfp"="e_muzstar","inflationtarget"="e_pitarget",
"consopreferences"="e_zetac","investmentefficiency"="e_zetai",
"risk"="risk","term"="e_term","monetary"="e_xp","transfer"="e_tauf")
data$time<-as.Date(data$time)
dataDecompo<-subset(data,!(shock == "sum_of_shocks")) #(13*2*102*13=34476)
dataSum<-subset(data,shock == "sum_of_shocks") #(13*2*102)
#dataTable
dataPost<-data.frame(c(dimnames(dataEA$post.mode[[1]])[[1]],
dimnames(dataEA$post.mode[[2]])[[1]],
dimnames(dataEA$post.mode[[3]])[[1]]),
unlist(dataEA[["post.mode"]]),unlist(dataEA[["post.mean"]]),
unlist(dataEA[["post.hdpinf"]]),unlist(dataEA[["post.hdpsup"]]),
unlist(dataUS[["post.mode"]]),unlist(dataUS[["post.mean"]]),
unlist(dataUS[["post.hdpinf"]]),unlist(dataUS[["post.hdpsup"]]))
names(dataPost)<-c("names","Post. mode EA","Post. mean EA","Prob. Interval 10% EA","Prob. Interval 90% EA","Post. mode US","Post. mean US","Prob. Interval 10% US","Prob. Interval 90% US")
dataPost$names<-gsub(".","_",dataPost$names,fixed=TRUE)
dataPrior<-data.frame(names=unlist(dataEA[["params.names"]]),
prior_mean=unlist(dataEA[["prior.mean"]]),
prior_stdv=sqrt(diag(unlist(dataEA[["prior.var"]]))))
#,prior_stdv=sqrt(unlist(dataEA[["prior.var"]]))
names(dataPrior)<-c('names','Prior mean','Prior stdv')
dataTable<-merge(dataPrior,dataPost,by="names",sort=F)
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-as.data.frame(t(as.data.frame(defsim)[22,]))
defsim["time"]<-year
View(defsim)
truc<-subset(dataRaw,country=="US" & shock == "rawdata4withoutmean" & variable == "def")$value
defsim["rawdata"]<-truc
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-as.data.frame(t(as.data.frame(defsim)[22,]))
defsim["time"]<-year
defsim["rawdata"]<-subset(dataRaw,country=="US" & shock == "rawdata4withoutmean" & variable == "def")$value
names(defsim)[1]<-"deficit"
dataDefSim<-melt(defsim,measure.vars=c("rawdata","deficit"))
str(dataDefSim["time"])
dataDefSim["time"]<-as.Date(dataDefSim["time"])
dataDefSim["time"]
as.Date(dataDefSim["time"])
as.character(dataDefSim["time"])
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-as.data.frame(t(as.data.frame(defsim)[22,]))
year<-seq(as.Date("1988/3/1"), as.Date("2013/6/1"), by = "3 months")
defsim["time"]<-year
defsim["rawdata"]<-subset(dataRaw,country=="US" & shock == "rawdata4withoutmean" & variable == "def")$value
names(defsim)[1]<-"deficit"
dataDefSim<-melt(defsim,measure.vars=c("rawdata","deficit"))
str(dataDefSim["time"])
library(R.matlab)
library(reshape2)
library(plyr)
library(lubridate)
setwd("C:/Users/Brand/Dropbox/cepii_dsge/output")
#dataCMR (annualized data_BAAoverTB.mat)
data<-readMat("rawdataCMR.mat")
year1<-seq(as.Date("1981/12/1"), as.Date("2010/6/1"), by = "3 months")
data<-data.frame(data,time=year1,country="US_CMR",shock="rawdataCMR")
rawdataCMR<-melt(data,id.vars=c("time","country","shock")) #12*118
rawdataCMR$variable<-gsub(".obs","",rawdataCMR$variable,fixed=TRUE)
rawdataCMR<-subset(rawdataCMR,year(time)>1987)
year<-as.character(seq(as.Date("1988/3/1"), as.Date("2013/6/1"), by = "3 months"))
#rawdata annualized, with or without mean (13x2x2x102=5304 obs.)
data<-read.csv("./rawdata4.csv",header=T,dec=',',sep=';')
data["time"]<-year
rawdata4<-melt(data,id.vars=c("time","country","shock"))
rawdata4$time<-as.Date(as.character(rawdata4$time))
rawdata4$variable<-gsub("_obs","",rawdata4$variable,fixed=TRUE)
dataRaw<-rbind(rawdata4,rawdataCMR) #(5304+1416)
dataEA<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_ea/table4/baseline/cmr_output.mat")
#obsnames contains 13 items (13observed variables)
obsnames<-gsub("_obs","",dataEA[["sim.endonames"]],fixed=TRUE)
obsnames<-gsub(" ","",obsnames,fixed=TRUE)
#exonames contains 21 items (13shocks+8news)
exonames<-gsub( " ", "",dataEA[["sim.exonames"]],fixed=TRUE)
datEA<-data.frame()
for (i in 1:length(obsnames)){
datEA<-rbind(datEA,data.frame(variable=obsnames[i],
name=c(exonames,"initial","sumshocks"),
dataEA[["sim"]][i,,]
)
)
}
datEA["country"]<-"EA"
dataUS<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline/cmr_output.mat")
datUS<-data.frame()
for (i in 1:length(obsnames)){
datUS<-rbind(datUS,data.frame(variable=obsnames[i],
name=c(exonames,"initial","sumshocks"),
dataUS[["sim"]][i,,]
)
)
}
datUS["country"]<-"US"
data<-rbind(datEA,datUS)
names(data)<-c("variable","shock",year,"country")
meltdata<-melt(data,measure.var=year) #(13*2*102*23=60996)
names(meltdata)[4]<-"time"
shocknewsnames<-exonames[9:17]
subdata<-subset(meltdata,shock %in% shocknewsnames)
risk_df<-data.frame(ddply(subdata,.(country,variable,time),summarize,value = sum(value)),shock="risk")
data<-subset(meltdata,!(shock %in% cbind(shocknewsnames,"initial")))
data<-rbind(data,risk_df)
levels(data$shock)<-list("sum_of_shocks"="sumshocks","technology"="e_epsil","govexp"="e_g","equity"="e_gamma",
"goodsmarkup"="e_lambdaf","investmentprod"="e_muup",
"tfp"="e_muzstar","inflationtarget"="e_pitarget",
"consopreferences"="e_zetac","investmentefficiency"="e_zetai",
"risk"="risk","term"="e_term","monetary"="e_xp","transfer"="e_tauf")
data$time<-as.Date(data$time)
dataDecompo<-subset(data,!(shock == "sum_of_shocks")) #(13*2*102*13=34476)
dataSum<-subset(data,shock == "sum_of_shocks") #(13*2*102)
#dataTable
dataPost<-data.frame(c(dimnames(dataEA$post.mode[[1]])[[1]],
dimnames(dataEA$post.mode[[2]])[[1]],
dimnames(dataEA$post.mode[[3]])[[1]]),
unlist(dataEA[["post.mode"]]),unlist(dataEA[["post.mean"]]),
unlist(dataEA[["post.hdpinf"]]),unlist(dataEA[["post.hdpsup"]]),
unlist(dataUS[["post.mode"]]),unlist(dataUS[["post.mean"]]),
unlist(dataUS[["post.hdpinf"]]),unlist(dataUS[["post.hdpsup"]]))
names(dataPost)<-c("names","Post. mode EA","Post. mean EA","Prob. Interval 10% EA","Prob. Interval 90% EA","Post. mode US","Post. mean US","Prob. Interval 10% US","Prob. Interval 90% US")
dataPost$names<-gsub(".","_",dataPost$names,fixed=TRUE)
dataPrior<-data.frame(names=unlist(dataEA[["params.names"]]),
prior_mean=unlist(dataEA[["prior.mean"]]),
prior_stdv=sqrt(diag(unlist(dataEA[["prior.var"]]))))
#,prior_stdv=sqrt(unlist(dataEA[["prior.var"]]))
names(dataPrior)<-c('names','Prior mean','Prior stdv')
dataTable<-merge(dataPrior,dataPost,by="names",sort=F)
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-as.data.frame(t(as.data.frame(defsim)[22,]))
year<-seq(as.Date("1988/3/1"), as.Date("2013/6/1"), by = "3 months")
defsim["time"]<-year
defsim["rawdata"]<-subset(dataRaw,country=="US" & shock == "rawdata4withoutmean" & variable == "def")$value
names(defsim)[1]<-"deficit"
dataDefSim<-melt(defsim,measure.vars=c("rawdata","deficit"))
#str(dataDefSim["time"])
#dataDefSim["time"]<-as.character(dataDefSim["time"])
save(obsnames,dataRaw,dataDecompo,dataSum,dataTable,dataDefSim,file="C:/Users/brand/Dropbox/github/riskshocks/data.RData")
View(dataDefSim)
setwd("C:/Users/brand/Dropbox/github/riskshocks")
runApp()
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsm<-as.data.frame(defsim)
View(defsm)
defsm<-as.data.frame(defsim)[22,]
View(defsm)
t(defsim)
defsim<-readMat("C:/Users/brand/Dropbox/cepii_dsge/cmrfiles_deficit/cmrfiles_us/table4/baseline_withoutdefinobs/cmr_def_simulated.mat")
defsim<-as.data.frame(defsim)[22,]
defsim<-as.data.frame(t(defsim)))
defsim<-as.data.frame(t(defsim))
View(defsim)
year<-seq(as.Date("1988/3/1"), as.Date("2013/6/1"), by = "3 months")
defsim["time"]<-year
defsim["rawdata"]<-subset(dataRaw,country=="US" & shock == "rawdata4withoutmean" & variable == "def")$value
View(defsim)
View(dataDefSim)
write.csv(dataDefSim)
write.csv(dataDefSim,file="defsim")
getwd()
write.csv(dataDefSim,file="defsim.csv")
setwd("C:/Users/brand/Dropbox/github/riskshocks")
runApp()
setwd("C:/Users/brand/Dropbox/github/riskshocks")
runApp()
View(dataTable)
round(dataTable)
Sys.setlocale("LC_TIME", "English_United States.1252")
library(shinyapps)
runApp()
deployApp()
